(self.modernJsonp=self.modernJsonp||[]).push([["55759"],{107056:function(e,t,n){n.r(t),n.d(t,{default:()=>E});var i=n(667294),o=n(312048),r=n(399353),a=n(550368),s=n(664659),l=n(996079),d=n(166988),c=n(77957),u=n(104999),p=n(746868),h=n(470205),m=n(935059),g=n(501010),x=n(765603),y=n(774838),v=n(341687),f=n(200619),C=n(601871),b=n(15392),j=n(113759),w=n(632492),P=n(510755),S=n(504727),_=n(9065),k=n(785893);let T=(0,_.Z)(()=>Promise.all([n.e("25418"),n.e("19838"),n.e("14055"),n.e("64701")]).then(n.bind(n,53867)),void 0,e=>53867,"SaveAffordance",e=>["25418","19838","14055","64701"]),Z=(0,_.Z)(()=>n.e("73301").then(n.bind(n,569369)),void 0,e=>569369,"PostDownloadUpsellPopover",e=>["73301"]),I=(0,_.Z)(()=>Promise.resolve().then(n.bind(n,53347)),void 0,e=>53347,"SecondarySendButtonCommon",e=>[]),D=(0,_.Z)(()=>Promise.all([n.e("25418"),n.e("96415")]).then(n.bind(n,872901)),void 0,e=>872901,"ReactionPickerContainer",e=>["25418","96415"]),A=(0,_.Z)(()=>n.e("8419").then(n.bind(n,391728)),void 0,e=>391728,"CloseupCommentButton",e=>["8419"]),B=(0,_.Z)(()=>n.e("12447").then(n.bind(n,683827)),{ssr:!1},e=>683827,"SharePinHoverContent",e=>["12447"]),R=({ref:e})=>{e.current&&(clearTimeout(e.current),e.current=null)},E=function({goBack:e,gridDescription:t,isDeletedStoryPin:n,inCommentsImprovedDropdownExp:_,inCommentsPopoverExp:E,isEligibleForAggregatedComments:M,isEligibleForPinReactions:L,isOnSecretBoard:z,onEditSubmit:H,pin:O,viewParameter:F,viewType:U,onSaveButtonClick:W,showRepinOnInitialRender:G,isStoryPin:Y,actionBarContainerRef:K,outerPaddingSize:J=b.g9,maxWidth:q,showLeadPin:N,scrollContainerRef:$}){let X=(0,o.TH)(),Q=(0,f.Z)(),V=(0,u.Z)(),{checkExperiment:ee}=(0,g.Z)(),{showEnabledSaveBehavior:et}=(0,S.Yh)(!0),{imgSrc:en}=(0,c.G)(),{clientTrackingParams:ei,showCloseupContentRight:eo,closeupWithinMasonryEnabled:er,peekCloseupEnabled:ea}=(0,j.x4)(),{viewType:es,viewParameter:el}=(0,p.SU)(),ed=(0,m.Z)(),ec=(0,C.q6)(ed,O?.pinner?.id,Q),eu=(0,d.Z)({showProductDetailPage:!!O.is_eligible_for_pdp}),ep=(0,i.useRef)(null),eh=(0,i.useRef)(null),em=(0,i.useRef)(null),[eg,ex]=(0,i.useState)(!!(0,v.Z)(X.search).share),[ey,ev]=(0,i.useState)(!1),[ef,eC]=(0,i.useState)(!1),[eb,ej]=(0,i.useState)(!1),{shareFromPostDownloadUpsell:ew,setShareFromPostDownloadUpsell:eP,saveToBoardFromPostDownloadUpsell:eS,setSaveToBoardFromPostDownloadUpsell:e_}=(0,a.tS)();ew&&(ex(!0),eP(!1));let ek=(0,i.useCallback)(e=>ev(e),[]),eT=(0,i.useCallback)(()=>ex(!1),[]),eZ=(0,i.useCallback)(()=>ex(e=>!e),[]),eI=(0,i.useCallback)(()=>{R({ref:ep}),R({ref:eh})},[]),eD=(0,i.useCallback)(()=>{V({event_type:101,component:15565}),eI(),eC(!1),ex(!0)},[eI,V]),eA=(0,i.useCallback)(()=>{eI(),eh.current=setTimeout(()=>{eC(!0)},1e3)},[eI]),eB=(0,i.useCallback)(()=>{eI(),ep.current=setTimeout(()=>{eC(!1),ep.current=null},300)},[eI]),eR=O.board?.owner?.id||O.pinner?.id,{aggregated_pin_data:eE,comments_disabled:eM,reaction_counts:eL}=O,{isRTL:ez}=(0,y.B)(),eH=er?q:q||b.Gg,eO=(0,l.Z)({pinKey:{type:"Legacy",data:O},orbacActingAs:Q,viewer:ed}),eF=!!Object.keys(eL||{}).length,eU=eE?.did_it_data?.images_count??0,eW=(eE?.comment_count??0)+eU,eG=em.current&&ee("ce_dweb_pin_rep_preview_on_share_icon_hover").anyEnabled&&!eg&&ef;(0,i.useEffect)(()=>{if(eG){let e=requestAnimationFrame(()=>ej(!0));return()=>cancelAnimationFrame(e)}ej(!1)},[eG]);let eY=z||n?null:(0,k.jsxs)(h.Z,{name:"CloseupActionBar_SecondarySendButton",children:[(0,k.jsx)(I,{anchorRef:em,closeupWithinMasonryEnabled:er,controllerOptions:{flyoutDisplayOptions:er?{shownWithinProfileHeader:!0,idealDirection:"down",forceDirection:!0}:{wrapperPosition:"fixed"},isFlyoutOpen:eg,loggingOptions:{component:194,element:72,viewParameter:F||el,viewType:U||es},onFlyoutDismiss:eT,onToggleFlyout:eZ,sendObject:{type:"pin",description:t,id:O.id,imageUrl:en,ownerId:eR,url:`/pin/${O.id}/`,clientTrackingParams:ei}},experienceAnchor:3025,onMouseEnter:eA,onMouseLeave:eB,shouldHideTooltip:!!eG,showSendAnimation:!0}),eG&&(0,k.jsx)(r.xu,{dangerouslySetInlineStyle:{__style:{opacity:+!!eb,transition:"opacity 300ms ease-out"}},onMouseEnter:eA,onMouseLeave:eB,children:(0,k.jsx)(r.J2,{anchor:em.current,idealDirection:"down",offset:4,onDismiss:()=>{},size:"flexible",children:(0,k.jsx)(r.iP,{onTap:eD,children:(0,k.jsx)(h.Z,{name:"CloseupActionBar_SharePinHoverContent",children:(0,k.jsx)(B,{pin:O})})})})})]}),eK=(0,k.jsx)(r.xu,{alignItems:"center",color:er?"transparent":"default","data-test-id":"closeup-action-items",display:"flex",justifyContent:"between",maxWidth:eH,role:"list",rounding:200,children:(0,k.jsxs)(r.kC,{alignItems:"stretch",gap:2*!!er,justifyContent:"start",children:[!ec&&!!L&&(0,k.jsx)(h.Z,{name:"CloseupActionBar_ReactionPickerContainer",children:(0,k.jsxs)(r.xu,{alignItems:"center",display:"flex",marginEnd:2*!!eF,role:"listitem",children:[(0,k.jsx)(D,{clientTrackingParams:ei,handleReactionTrayHover:ek,idealDirection:er?"down":void 0,pinId:O.id,reactionByMe:O.reaction_by_me,showTooltip:!0,viewParameter:F,viewType:U}),(0,k.jsx)(x.Z,{pinId:O.id,reactionCounts:eL,showPrettyNumber:!0})]})}),er&&!(_&&eM)&&(0,k.jsx)(A,{inCommentsImprovedDropdownExp:!!_,inCommentsPopoverExp:!!E,isEligibleForAggregatedComments:!!M,pinKey:{type:"Legacy",data:O},scrollContainerRef:$,shouldShowCommentCount:!eM&&!!eW&&(!!E||!!_),totalCommentCount:eW,viewParameter:F,viewType:U}),(0,k.jsx)(r.xu,{role:"listitem",children:eY}),(0,k.jsx)(r.xu,{"data-test-id":"closeup-more-options",role:"listitem",children:(0,k.jsx)(s.Z,{carouselSlotCurrentIndex:O&&O.carousel_data&&O.carousel_data.index,clientTrackingParams:ei,closeupWithinMasonryEnabled:er,goBack:e,isReactionTrayOpen:ey,onEditSubmit:H,pinKey:{type:"Legacy",data:O},showEditPin:!n&&eO,viewParameter:F,viewType:U})})]})}),eJ=er?void 0:J,eq=(0,k.jsxs)(r.xu,{ref:K,color:"default",dangerouslySetInlineStyle:{__style:{paddingTop:J/2,paddingRight:ez?void 0:eJ,paddingLeft:ez?eJ:void 0,paddingBottom:er?J/2:void 0,borderRadius:Y?"0px 32px 32px 32px":eo?"0px 32px 32px 0":void 0}},"data-test-id":"closeup-body-sticky-content",marginTop:er?0:Y?-5:0,width:er?"100%":void 0,children:[(0,k.jsx)(r.xu,{"data-test-id":"closeupActionBar",marginStart:eu?-3:void 0,children:(0,k.jsxs)(r.kC,{alignItems:"stretch",justifyContent:"between",children:[eK,(0,k.jsx)(r.kC,{alignItems:"center",gap:2,children:!n&&!ec&&(0,k.jsx)(r.xu,{marginStart:3*!er,children:(0,k.jsx)(T,{boardCount:ed.isAuth?ed.boardCount:0,clientTrackingParams:ei,onClickCallback:W,pinKey:{type:"Legacy",data:O},saveToBoardFromPostDownloadUpsell:eS,setSaveToBoardFromPostDownloadUpsell:e_,showEnabledSaveBehavior:et,showRepinOnInitialRender:G,variant:"closeup",viewParameter:F,viewType:U})})})]})}),(0,k.jsx)(Z,{})]});if(N||er)return eq;let eN=Y&&!ea?P.cI+4:P.hu;return ea&&(eN=0),(0,k.jsx)(r.Le,{top:eN,zIndex:w.mS,children:eq})}},765603:function(e,t,n){n.d(t,{Z:()=>x});var i=n(667294),o=n(399353),r=n(361004),a=n(104999),s=n(24246),l=n(507006),d=n(729586),c=n(518596),u=n(825605),p=n(785893);function h(e,t,n){var i;return(t="symbol"==typeof(i=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var i=n.call(e,t||"default");if("object"!=typeof i)return i;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(t,"string"))?i:i+"")in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}let m=(0,i.lazy)(()=>n.e("25993").then(n.bind(n,581897)));class g extends i.PureComponent{constructor(...e){super(...e),h(this,"state",{displayAggregationModal:!1}),h(this,"showAggregationModal",()=>{let{disableModal:e,logContextEvent:t}=this.props;e||(this.setState({displayAggregationModal:!0}),t({event_type:101,view_type:3,view_parameter:139,component:13458,element:11435,aux_data:{objectId:this.props.pinId}}))}),h(this,"hideAggregationModal",()=>{this.setState({displayAggregationModal:!1})})}render(){let{displayAggregationModal:e}=this.state,{isBold:t,isStoryPin:n,paddingY:i,pinId:a,reactionCounts:s,showPrettyNumber:h,size:g}=this.props,x=s?(0,c.At)(s):null,y=s?(0,c.Ud)(s):0,v=!!x&&x.length>0&&x.filter(e=>!!d.GY[e]).map((e,t)=>{let n=e&&d.GY[e]?d.GY[e]:"",{label:i,gridAsset:r}=(0,d.fW)(n,this.props.i18n);return(0,p.jsx)(o.xu,{dangerouslySetInlineStyle:{__style:{marginRight:2}},children:(0,p.jsx)(o.xu,{height:19,width:19,children:r&&(0,p.jsx)(o.Ee,{alt:i??"",fit:"cover",naturalHeight:1,naturalWidth:1,src:r})})},t)});return(0,p.jsxs)(o.xu,{children:[(0,p.jsx)(o.iP,{accessibilityLabel:`${y} reactions`,dataTestId:"reactions-count-button",onTap:this.showAggregationModal,children:!!v&&(0,p.jsx)(o.xu,{"data-test-id":"aggregated-reactions-container",display:"inlineBlock",children:h?(0,p.jsx)(o.xu,{dangerouslySetInlineStyle:{__style:{cursor:"pointer"}},children:(0,p.jsx)(o.xe,{size:g??r.n,weight:"bold",children:(0,p.jsx)(l.Z,{shortform:!0,shortformMaximumFractionDigits:1,value:y})})}):(0,p.jsxs)(o.xu,{alignItems:"center",dangerouslySetInlineStyle:{__style:{cursor:"pointer"}},"data-test-id":"aggregated-reactions-container",direction:"row",display:"flex",height:n?"auto":19,paddingY:i??6*!n,children:[(0,p.jsx)(o.kC,{alignItems:"stretch",direction:"row",justifyContent:"start",children:v}),(0,p.jsx)(o.xu,{paddingX:1,children:(0,p.jsx)(o.xe,{color:t?"default":"subtle",size:g??r.n,weight:t?"bold":"normal",children:(0,p.jsx)(l.Z,{shortform:!0,shortformMaximumFractionDigits:1,value:y})})})]})})}),e&&y&&(0,p.jsx)(u.Z,{children:(0,p.jsx)(m,{aggregatedReactions:v,onDismiss:this.hideAggregationModal,pinId:a,totalReactionCount:y})})]})}}h(g,"defaultProps",{isBold:!0});let x=function(e){let t=(0,s.Z)(),n=(0,a.Z)();return(0,p.jsx)(g,{...e,i18n:t,logContextEvent:n})}}}]);
//# sourceMappingURL=https://sm.pinimg.com/webapp/CloseupActionBarCommon-e6eaa677b4c0d8af.mjs.map